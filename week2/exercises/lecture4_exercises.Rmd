---
title: "Lecture 4 Exercises"
output: html_document
---

**Continuation of your work on smooth function estimation with the data in curve_data.txt.**

```{r}
# install.packages('mvtnorm')
# Write a function that takes as input a vector of prediction input values, and returns the mean and the precision of the predictive distribution at each of these inputs.
fitted.bayes <- function(inputs, training_data) {
  # create a wbayes result from the training data
  
  # calculate mean and variance for each of the inputs using wbayes
  
}

```

**2. Show that the mean of the predictive distribution at an input location x, $φ(x)^{T} w_{Bayes}$ can be represented as $$\sum_{n=1}^{N} qφ(x)^{T} Q^{−1}φ(x_{n})t_{n}$$ therefore, as a linear combination of the training outputs $t_{n}$.**

We know that the predictive distribution is given by (slide 3):

$t_{N+1}|t,X,x_{N+1} ∼ N(φ(x_{N+1})^{T}w_{Bayes},φ(x_{N+1})^{T}Q^{−1}φ(x_{N+1})+q^{−1})$

From this we know the mean of the predictive distribution at **x** is: $φ(\textbf{x})^{T}w_{Bayes}$

and the equation is given by $w_{Bayes} = qQ^{−1}φ^{T}t$

At **x**, $φ^{T}t$ is $$\sum_{n=1}^{N} φ(x_{n})t_{n}$$

So we get the final result that the mean of the predictive distribution at **x** is:

$$\sum_{n=1}^{N} q φ(x)^{T} Q^{-1} φ(x_{n})t_{n}$$


**4. Notice that, by expanding Q,**

$K=q\phi(\delta I+q\phi^{T}\phi)^{−1}\phi^{T}  = \phi(\lambda I+\phi^{T}\phi)^{−1}\phi^{T}$.

**Show that when $\lambda = 0$, and provided $\phi^{T}\phi$ is invertible, K is precisely the “hat” matrix of linear regression. Therefore, the matrix of kernel weights provides a Bayesian version of such matrix. We will revisit this later in the course.**

The "Hat" matrix from linear regression is given by:

$H = \phi(\phi^{T}\phi)^{−1}\phi^{T}$

When $\lambda = 0$, the first term in paranthesis:

$K = \phi(\lambda I+\phi^{T}\phi)^{−1}\phi^{T}$

is a matrix of zeroes and thus when multiplied by $\phi$ is still a matrix of zeros so we remove it from the equation and the equation reduces to:

$K = H = \phi(\phi^{T}\phi)^{−1}\phi^{T}$
