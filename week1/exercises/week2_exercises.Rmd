## Exercise Set 2

1. ADD ME

2. ADD ME

3. Extract the first 300 rows and 1001 columns from the synthetic_regression.txt dataset; hence you have 300 replica- tions and 1000 input variables.


```{r}
setwd('~/Desktop/term1_courses/Statistical Modelling and Inference/')
# Read in first 300 rows
synthetic_data <- read.csv('synthetic_regression.txt', header = TRUE, nrows = 300, sep = " ")
# already has 1001 columns
ncol(synthetic_data)
# [1] 1001

svdvals <- svd(synthetic_data[,2:1001])
D <- diag(svdvals$d)
dim(D)
plot(svdvals$d)
nonzeroD <- D[D > 0]
plot(nonzeroD)

library(Matrix)
rankMatrix(synthetic_data, sval = svdvals$d)

# Checking things out
constructed <- svdvals$u %*% diag(svdvals$d) %*% t(svdvals$v)
constructed[2,1]
synthetic_data[2,1]

constructedD <- t(svdvals$u) %*% as.matrix(synthetic_data) %*% svdvals$v
constructedD[1,1]
nonzeroD[1]

phi = synthetic_data[,2:1001]
#phi <- cbind(rep(1,300), phi)
phi <- as.matrix(phi)
svdphitphi <- svd(phi)
U <- svdphitphi$u
D <- diag(svdphitphi$d)
V <- svdphitphi$v

# install.packages('matrixcalc')
library('matrixcalc')
Vr = phi %*% U %*% matrix.power(D, 0.5)

```